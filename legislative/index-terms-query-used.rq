SELECT DISTINCT
  ?house ?houseLabel
  ?legislature ?legislatureLabel
  ?term ?termLabel
  ?termStart ?termEnd
  ?termSpecificPosition
WHERE {
  VALUES (?house ?position) {
    (wd:Q783330 wd:Q6814428)
    (wd:Q783401 wd:Q18912794)
    (wd:Q2867120 wd:Q19007285)
    (wd:Q2994118 wd:Q19627913)
    (wd:Q2994121 wd:Q19299542)
    (wd:Q3244676 wd:Q18810377)
    (wd:Q4386693 wd:Q18534408)
    (wd:Q494915 wd:Q6814365)
    (wd:Q6518214 wd:Q18526194)
    (wd:Q7566117 wd:Q18220900)
    (wd:Q7566128 wd:Q18662245)
    (wd:Q7987530 wd:Q20165902)
    (wd:Q9302011 wd:Q19185341)
    (wd:Q9390783 wd:Q19202748)
    (wd:Q9390785 wd:Q26998278)
    (wd:Q28223935 wd:Q56477796)
    (wd:Q56477506 wd:Q56477508)
    (wd:Q56477512 wd:Q56477513)
    (wd:Q56477516 wd:Q56477518)
    (wd:Q56477522 wd:Q56477523)
    (wd:Q56477526 wd:Q56477527)
    (wd:Q56477532 wd:Q56477533)
    (wd:Q56477536 wd:Q56477537)
    (wd:Q56477541 wd:Q56477543)
    (wd:Q56477546 wd:Q56477547)
    (wd:Q56477552 wd:Q56477553)
    (wd:Q56477556 wd:Q56477557)
    (wd:Q56477560 wd:Q56477561)
    (wd:Q56477564 wd:Q56477565)
    (wd:Q56477569 wd:Q56477571)
    (wd:Q56477574 wd:Q56477576)
    (wd:Q56477579 wd:Q56477580)
    (wd:Q56477584 wd:Q56477585)
    (wd:Q56477588 wd:Q56477589)
    (wd:Q56477592 wd:Q56477593)
    (wd:Q56477596 wd:Q56477597)
    (wd:Q56477600 wd:Q56477601)
    (wd:Q56477604 wd:Q56477605)
    (wd:Q56477608 wd:Q56477609)
    (wd:Q56477613 wd:Q56477614)
    (wd:Q56477617 wd:Q56477618)
    (wd:Q56477622 wd:Q56477623)
    (wd:Q56477626 wd:Q56477627)
    (wd:Q56477632 wd:Q56477633)
    (wd:Q56477636 wd:Q56477637)
    (wd:Q56477640 wd:Q56477641)
    (wd:Q56477644 wd:Q56477645)
    (wd:Q56477648 wd:Q56477649)
    (wd:Q56477652 wd:Q56477653)
    (wd:Q56477656 wd:Q56477657)
    (wd:Q56477660 wd:Q56477661)
    (wd:Q56477664 wd:Q56477665)
    (wd:Q56477668 wd:Q56477669)
    (wd:Q56477672 wd:Q56477673)
    (wd:Q56477676 wd:Q56477678)
    (wd:Q56477681 wd:Q56477682)
    (wd:Q56477685 wd:Q56477686)
    (wd:Q56477689 wd:Q56477690)
    (wd:Q56477693 wd:Q56477694)
    (wd:Q56477697 wd:Q56477698)
    (wd:Q56477701 wd:Q56477702)
    (wd:Q56477705 wd:Q56477706)
    (wd:Q56477709 wd:Q56477710)
    (wd:Q56477713 wd:Q56477714)
    (wd:Q56477713 wd:Q56876060)
    (wd:Q56477717 wd:Q56477718)
    (wd:Q56477721 wd:Q56477722)
    (wd:Q56477727 wd:Q56477728)
    (wd:Q56477731 wd:Q56477732)
    (wd:Q56477735 wd:Q56477736)
    (wd:Q56477739 wd:Q56477740)
    (wd:Q56477743 wd:Q56477744)
    (wd:Q56477747 wd:Q56477748)
    (wd:Q56477751 wd:Q56477752)
    (wd:Q56477755 wd:Q56477756)
    (wd:Q56477759 wd:Q56477760)
    (wd:Q56477763 wd:Q56477764)
    (wd:Q56477767 wd:Q56477768)
    (wd:Q56477771 wd:Q56477772)
    (wd:Q56477775 wd:Q56477776)
    (wd:Q56477779 wd:Q56477780)
    (wd:Q56477783 wd:Q56477784)
    (wd:Q56477787 wd:Q56477788)
    (wd:Q56477791 wd:Q56477792)
    (wd:Q56477799 wd:Q56477800)
    (wd:Q56477803 wd:Q56477804)
    (wd:Q56477807 wd:Q56477808)
    (wd:Q56477811 wd:Q56477812)
    (wd:Q56477816 wd:Q56477817)
    (wd:Q56477820 wd:Q56477821)
    (wd:Q56477824 wd:Q56477825)
    (wd:Q56477828 wd:Q56477829)
    (wd:Q56477832 wd:Q56477833)
    (wd:Q56477836 wd:Q56477837)
    (wd:Q56477840 wd:Q56477841)
    (wd:Q56477844 wd:Q56477845)
    (wd:Q56477848 wd:Q56477849)
    (wd:Q56477852 wd:Q56477853)
    (wd:Q56477856 wd:Q56477857)
    (wd:Q56477860 wd:Q56477861)
    (wd:Q56477864 wd:Q56477865)
    (wd:Q56477868 wd:Q56477869)
    (wd:Q56477872 wd:Q56477873)
    (wd:Q56477876 wd:Q56477877)
    (wd:Q56477880 wd:Q56477881)
    (wd:Q56477884 wd:Q56477885)
    (wd:Q56477888 wd:Q56477889)
    (wd:Q56477892 wd:Q56477893)
    (wd:Q56477896 wd:Q56477897)
    (wd:Q56477900 wd:Q56477901)
    (wd:Q56477904 wd:Q56477905)
    (wd:Q56477908 wd:Q56477909)
    (wd:Q56477912 wd:Q56477913)
    (wd:Q56477916 wd:Q56477917)
    (wd:Q56477920 wd:Q56477921)
    (wd:Q56477926 wd:Q56477927)
    (wd:Q56477930 wd:Q56477931)
    (wd:Q56477934 wd:Q56477935)
    (wd:Q56477938 wd:Q56477939)
    (wd:Q56477942 wd:Q56477943)
    (wd:Q56477947 wd:Q56477948)
  }
  ?house (p:P361/ps:P361)* ?legislature .
      ?baseTerm p:P31|p:P279 [ ps:P279|ps:P31 wd:Q15238777 ; pq:P642 ?legislature ] .
      OPTIONAL { ?subTerm wdt:P31 ?baseTerm }

  BIND(COALESCE(?subTerm, ?baseTerm) AS ?term)

  OPTIONAL { ?term (wdt:P580|wdt:P571) ?termStart. }
  OPTIONAL { ?term (wdt:P582|wdt:P576) ?termEnd. }
  OPTIONAL { ?term (wdt:P155|wdt:P1365) ?termReplaces }
  OPTIONAL { ?term (wdt:P156|wdt:P1366) ?termReplacedBy }
  OPTIONAL {
    ?termSpecificPosition wdt:P31/wdt:P279* wd:Q4164871 ;
                          p:P279 [ ps:P279 ?position ;
                                   pq:P2937 ?term ] .
  }

  FILTER (!BOUND(?termEnd) || ?termEnd > NOW())
  FILTER (!BOUND(?termReplacedBy))
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }
} ORDER BY ?termStart ?term
